<!DOCTYPE html>
<html>
<head>
  <title>Simple Payment Page</title>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <style>
    /* Basic styling for layout */
    body { font-family: sans-serif; }
    #payment-form { margin: 20px; }
    input[type="number"] { padding: 5px; margin-bottom: 10px; }
    button { padding: 10px 20px; cursor: pointer; }
  </style>
</head>
<body>
  <div id="payment-form">
    <h1>Enter Amount</h1>
    <label for="amount">Amount (INR):</label>
    <input type="number" id="amount" name="amount" value="100" required><br>
    <button id="pay-button">Pay Now</button>
  </div>

  <div id="payment-result"></div>

  <script>
    const payButton = document.getElementById('pay-button');
    const amountInput = document.getElementById('amount');
    const paymentResultDiv = document.getElementById('payment-result');

    payButton.addEventListener('click', async () => {
      const amount = amountInput.value;

      // Create a Razorpay order on the server
      const response = await fetch('/create-order', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ amount: amount }),
      });

      const data = await response.json();

      if (data.success) {
        // Initialize Razorpay Checkout
        const options = {
          key: 'YOUR_RAZORPAY_KEY_ID', // Replace with your key ID
          amount: data.order.amount, // Amount in paise (e.g., 100 INR = 10000 paise)
          currency: data.order.currency,
          name: 'Your Company Name',
          description: 'Payment for your products/services',
          image: 'URL_TO_YOUR_LOGO', // Optional
          order_id: data.order.id, // Order ID generated by Razorpay
          handler: function (response) {
            // Payment success callback
            paymentResultDiv.innerHTML = `
              <h1>Payment Successful!</h1>
              <p>Payment ID: ${response.razorpay_payment_id}</p>
              <p>Order ID: ${response.razorpay_order_id}</p>
              <p>Signature: ${response.razorpay_signature}</p>
            `;

            // You should verify the signature on your server!
            // (See the server-side code example for how to do this)
            // Verify Signature using another API call

          },
          prefill: {  // Optional, pre-fill customer details
            name: 'John Doe',
            email: 'john.doe@example.com',
            contact: '1234567890',
          },
          notes: {
            address: 'Example Address', // Optional notes
          },
          theme: {
            color: '#3399cc',  // Optional color customization
          },
          modal: {
            escape: false,     // Disable closing the modal by pressing Esc
          },
        };

        const rzp1 = new Razorpay(options);
        rzp1.on('payment.failed', function (response) {
          paymentResultDiv.innerHTML = `<h1>Payment Failed!</h1><p>${response.error.description}</p>`;
        });
        rzp1.open();
      } else {
        paymentResultDiv.innerHTML = `<h1>Error</h1><p>${data.message}</p>`;
      }
    });
  </script>
</body>
</html>
